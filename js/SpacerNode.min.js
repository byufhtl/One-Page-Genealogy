function SquareNode(b,c,a,d){this.x=b;this.y=0;this.width=c;this.height=a;this.id=d}SquareNode.prototype.getTopBorder=function(){return[{x1:this.x,x2:this.x+this.width,y:0}]};SquareNode.prototype.getBottomBorder=function(){return[{x1:this.x,x2:this.x+this.width,y:this.height}]};SquareNode.prototype.getParentBounds=function(){return{top:0,bottom:this.height}};SquareNode.prototype.getRectangles=function(a){return[{x:this.x,y:this.y+a,width:this.width,height:this.height,id:this.id}]};SquareNode.prototype.isSquare=function(){return true};function MultiNode(c,d,a,b){this.top=d;this.bottom=a;this.children=b;this.bounds=c;this.rectangle={};this.parent=null;this.y=0}MultiNode.prototype.getTopBorder=function(){return this.top};MultiNode.prototype.getBottomBorder=function(){return this.bottom};MultiNode.prototype.getParentBounds=function(){return this.bounds};MultiNode.prototype.getRectangles=function(b){if(b===undefined){b=this.y}var e=[];var a=[];for(var d=0;d<this.children.length;d++){a=this.children[d].getRectangles(b+this.y);e=e.concat(a)}if(this.parent){var c=this.parent.getRectangles(b+this.y);e=e.concat(c)}return e};MultiNode.prototype.isSquare=function(){return false};MultiNode.generate=function(b,c,d){var a;if(c.length==1){return MultiNode.mergeOneChild(b,c[0])}else{var e=MultiNode.mergeChildrenTopToBottom(c.slice(d,c.length));a=MultiNode.mergeChildrenBottomToTop(c.slice(0,d))}e.bounds=c[d].getParentBounds();return MultiNode.mergeParentWithChildren(b,a,e)};MultiNode.mergeOneChild=function(e,f){var c=MultiNode.compareBorders2(f.getBottomBorder(),e.getTopBorder(),Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY);if(c==Number.NEGATIVE_INFINITY){var a=(f.getParentBounds().bottom+f.getParentBounds().top)/2;var d=a-e.height/2;mergedTop=MultiNode.mergeList(f.getTopBorder(),e.getTopBorder(),0,d,1);mergedBtm=MultiNode.mergeList(e.getBottomBorder(),f.getBottomBorder(),d,0,-1);e.y=d;f.y=0}else{mergedTop=MultiNode.mergeList(f.getTopBorder(),e.getTopBorder(),0,c,1);mergedBtm=MultiNode.mergeList(e.getBottomBorder(),f.getBottomBorder(),c,0,-1);e.y=c;f.y=0}var b=new MultiNode({top:e.y,bottom:e.y+e.height},mergedTop,mergedBtm,[f]);b.parent=e;return b};MultiNode.mergeParentWithChildren=function(l,h,n,k){var e=MultiNode.compareBorders2(h.getBottomBorder(),l.getTopBorder(),Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY);var c=MultiNode.compareBorders2(l.getBottomBorder(),n.getTopBorder(),Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY);var o=MultiNode.compareBorders2(h.getBottomBorder(),n.getTopBorder(),h.getParentBounds().bottom,n.getParentBounds().top);var f;var j;if(e==Number.NEGATIVE_INFINITY){if(c==Number.NEGATIVE_INFINITY){var i=o-(h.getParentBounds().bottom-n.getParentBounds().top);var m=n.getParentBounds().top+o;var b=h.getParentBounds().bottom;var p=(m+b)/2-l.height/2;f=MultiNode.mergeList(h.getTopBorder(),l.getTopBorder(),0,p,1);j=MultiNode.mergeList(l.getBottomBorder(),h.getBottomBorder(),p,0,-1);f=MultiNode.mergeList(f,n.getTopBorder(),0,o,-1);j=MultiNode.mergeList(n.getBottomBorder(),j,o,0,1);l.y=p;h.y=0;n.y=o}else{f=MultiNode.mergeList(l.getTopBorder(),n.getTopBorder(),0,c,1);j=MultiNode.mergeList(n.getBottomBorder(),l.getBottomBorder(),c,0,-1);f=MultiNode.mergeList(h.getTopBorder(),f,0,o-c,1);j=MultiNode.mergeList(j,h.getBottomBorder(),o-c,0,-1);l.y=o-c;h.y=0;n.y=o}}else{var d=0;var a=0;if(c!=Number.NEGATIVE_INFINITY){spare=e+c-o;if(spare>0){d=spare}else{a=-spare/2}}if(c==Number.NEGATIVE_INFINITY){a=Math.max(e,o-l.height/2)-e}f=MultiNode.mergeList(h.getTopBorder(),l.getTopBorder(),0,e+a,1);j=MultiNode.mergeList(l.getBottomBorder(),h.getBottomBorder(),e+a,0,-1);f=MultiNode.mergeList(f,n.getTopBorder(),0,o+d,-1);j=MultiNode.mergeList(n.getBottomBorder(),j,o+d,0,1);l.y=e+a;h.y=0;n.y=o+d}var g=new MultiNode({top:l.y,bottom:l.y+l.height},f,j,[h,n]);g.parent=l;return g};MultiNode.mergeChildrenBottomToTop=function(c){var b=MultiNode.mergeChildrenTopToBottom(c);var a=c[c.length-1].getParentBounds();a.top+=c[c.length-1].y;a.bottom+=c[c.length-1].y;b.bounds=a;return b};MultiNode.mergeChildrenTopToBottom=function(f){var e=f[0];e.y=0;var h=e.getTopBorder();var d=e.getBottomBorder();compareSum=0;compareSum2=0;for(var a=1;a<f.length;a++){var b=f[a];var g=MultiNode.compareBorders2(d,b.getTopBorder(),e.getParentBounds().bottom+compareSum,b.getParentBounds().top);compareSum=g;b.y=compareSum;mergedTop=MultiNode.mergeList(h,b.getTopBorder(),0,compareSum,1);mergedBtm=MultiNode.mergeList(b.getBottomBorder(),d,compareSum,0,-1);e=b;h=mergedTop;d=mergedBtm}largestBtm=Number.NEGATIVE_INFINITY;for(var a=0;a<d.length;a++){if(d[a].y>largestBtm){largestBtm=d[a].y}}smallestTop=Number.POSITIVE_INFINITY;for(var a=0;a<h.length;a++){if(h[a].y<smallestTop){smallestTop=h[a].y}}var c=f[0].getParentBounds();c.top+=f[0].y;c.bottom+=f[0].y;return new MultiNode(c,h,d,f)};MultiNode.compareBorders2=function(c,k,f,h){var a=0;var d=0;var e;e=Number.NEGATIVE_INFINITY;while(a<c.length&&d<k.length){var j=c[a];var g=k[d];if(g.x1<j.x2&&g.x2>j.x1){var i=j.y-g.y;if(i>e){e=i}}else{}if(j.x2<=g.x2){a++}if(g.x2<=j.x2){d++}}return Math.max(e,f-h)};MultiNode.mergeList=function(f,a,e,c,g){for(var d=0;d<f.length;d++){f[d].y+=e}a.sort(function(i,h){if(i.y==h.y){return 0}if(i.y>h.y){return g}return -g});for(var d=0;d<a.length;d++){var b=a[d];f=MultiNode.addLine(f,b.x1,b.x2,b.y+c)}return f};MultiNode.addLine=function(f,c,b,h){if(c>=b){console.log("invalid line");return}var g=false;var e=[];for(var d=0;d<f.length;d++){var a=f[d];if(b-c<=0){g=true;break}if(c<=a.x2&&b>=a.x1){if(c<a.x1){e.push({x1:c,x2:a.x1,y:h})}if(b>a.x2){c=a.x2}else{g=true;break}}}if(!g&&b-c>0){e.push({x1:c,x2:b,y:h})}e=e.concat(f);e.sort(function(j,i){if(j.x1==i.x1){return 0}if(j.x1>i.x1){return 1}return -1});return e};